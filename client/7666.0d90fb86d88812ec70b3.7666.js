"use strict";(this.webpackChunksemaphore=this.webpackChunksemaphore||[]).push([[7666],{9076:(t,e,r)=>{r.d(e,{V:()=>o});var s=r(385),a=r(4886);async function o(t,e,r,o,n,i){const l=function(t){switch(t){case"local":case"federated":return"timelines/public";case"home":return"timelines/home";case"notifications":case"notifications/mentions":return"notifications";case"favorites":return"favourites";case"direct":return"conversations";case"bookmarks":return"bookmarks"}if(t.startsWith("tag/"))return"timelines/tag";if(t.startsWith("account/"))return"accounts";if(t.startsWith("list/"))return"timelines/list";throw new Error(`Invalid timeline type: ${t}`)}(r);let c=`${(0,a.E)(t)}/api/v1/${l}`;r.startsWith("tag/")?c+="/"+r.split("/")[1]:r.startsWith("account/")?c+="/"+r.split("/")[1]+"/statuses":r.startsWith("list/")&&(c+="/"+r.split("/")[1]);const d={};n&&(d.since_id=n),o&&(d.max_id=o),i&&(d.limit=i),"local"===r&&(d.local=!0),r.startsWith("account/")&&(r.endsWith("media")?d.only_media=!0:d.exclude_replies=!r.endsWith("/with_replies")),"notifications/mentions"===r&&(d.exclude_types=["follow","favourite","reblog","poll","admin.sign_up","update","follow_request","admin.report"]),c+="?"+(0,s.pe)(d);let{json:p,headers:u}=await(0,s.SM)(c,(0,a.I)(e),{timeout:s.EH});return"direct"===r&&(p=p.map((t=>t.last_status)).filter(Boolean)),{items:p,headers:u}}},7666:(t,e,r)=>{r.r(e),r.d(e,{default:()=>k});var s=r(4178),a=r(5291),o=r(5984),n=r(9065),i=r(2771),l=r(6288),c=r(5277),d=r(9076);var p=r(9006),u=r(7031),h=r(4886),f=r(385);var m=r(6633);async function v(t,e,r,s){const{currentInstance:a,accessToken:o}=c.h.get();try{await async function(t,e,r,s,a,o){const n=`${(0,h.E)(t)}/api/v1/reports`;return(0,f.v_)(n,{account_id:r,status_ids:s,comment:a,forward:o},(0,h.I)(e))}(a,o,t.id,e,r,s),u.A.say("Submitted report")}catch(n){u.A.say((0,m.A)(["Failed to report: ",["error"]],{error:n.message||""}))}}var y={show:n.$,close:i.x,onChange(t,e){const r=e.target.checked,{reportMap:s}=this.get();s[t]=r},async doReport(){const{displayStatuses:t,account:e,comment:r,forward:s,reportMap:a}=this.get(),o=t.map((({id:t})=>t)).filter((t=>a[t]));o.length?await v(e,o,r,s):u.A.say("No toots to report")}};async function w(){l.U.call(this);const{account:t,status:e,reportMap:r}=this.get();e&&(r[e.id]=!0);try{const e=await async function(t){const{currentInstance:e,accessToken:r}=c.h.get();return(await(0,d.V)(e,r,`account/${t}`,null,null,20)).items}(t.id);this.set({recentStatuses:e})}catch(s){console.error(s),u.A.say((0,m.A)(["Unable to load recent toots: ",["error"]],{error:s.message||""}))}finally{this.set({loading:!1})}}function g(t){const{component:e,ctx:r}=this._svelte;e.onChange(r.status.id,t)}function x(t,e,r){const s=Object.create(t);return s.status=e[r],s}function b(t,e){var r,a=[],o=(0,s.L7)(),n=e.displayStatuses;const i=t=>t.status.id;for(var l=0;l<n.length;l+=1){let r=x(e,n,l),s=i(r);a[l]=o[s]=j(t,s,r)}return{c(){for(r=(0,s.az)("ul"),l=0;l<a.length;l+=1)a[l].c();this.h()},l(t){r=(0,s.d$)(t,"UL",{class:!0},!1);var e=(0,s.pI)(r);for(l=0;l<a.length;l+=1)a[l].l(e);e.forEach(s.r2),this.h()},h(){r.className="svelte-1jqy48r"},m(t,e){for((0,s.$T)(t,r,e),l=0;l<a.length;l+=1)a[l].m(r,null)},p(e,n){const l=n.displayStatuses;a=(0,s.$q)(a,t,e,i,1,n,l,o,r,s.pp,j,"m",null,x)},d(t){for(t&&(0,s.r2)(r),l=0;l<a.length;l+=1)a[l].d()}}}function _(t,e){var r,a=new o.Z({root:t.root,store:t.store});return{c(){r=(0,s.az)("div"),a._fragment.c(),this.h()},l(t){r=(0,s.d$)(t,"DIV",{class:!0},!1);var e=(0,s.pI)(r);a._fragment.l(e),e.forEach(s.r2),this.h()},h(){r.className="loading-spinner-container svelte-1jqy48r"},m(t,e){(0,s.$T)(t,r,e),a._mount(r,null)},p:s.ZT,d(t){t&&(0,s.r2)(r),a.destroy()}}}function j(t,e,r){var a,o,n,i,l,c,d,p,u,h=r.status.text;return{key:e,first:null,c(){a=(0,s.az)("li"),o=(0,s.az)("input"),c=(0,s.rw)("\n                "),d=(0,s.az)("label"),p=(0,s.rw)(h),this.h()},l(t){a=(0,s.d$)(t,"LI",{class:!0},!1);var e=(0,s.pI)(a);o=(0,s.d$)(e,"INPUT",{type:!0,id:!0,name:!0,checked:!0,class:!0},!1),(0,s.pI)(o).forEach(s.r2),c=(0,s.M4)(e,"\n                "),d=(0,s.d$)(e,"LABEL",{for:!0,class:!0},!1);var r=(0,s.pI)(d);p=(0,s.M4)(r,h),r.forEach(s.r2),e.forEach(s.r2),this.h()},h(){o._svelte={component:t,ctx:r},(0,s.NH)(o,"change",g),(0,s.P$)(o,"type","checkbox"),o.id=n="status-report-"+r.status.id,o.name=i="status-report-"+r.status.id,o.checked=l=r.status.report,o.className="svelte-1jqy48r",d.htmlFor=u="status-report-"+r.status.id,d.className="svelte-1jqy48r",a.className="svelte-1jqy48r",this.first=a},m(t,e){(0,s.$T)(t,a,e),(0,s.R3)(a,o),(0,s.R3)(a,c),(0,s.R3)(a,d),(0,s.R3)(d,p)},p(t,e){r=e,o._svelte.ctx=r,t.displayStatuses&&n!==(n="status-report-"+r.status.id)&&(o.id=n),t.displayStatuses&&i!==(i="status-report-"+r.status.id)&&(o.name=i),t.displayStatuses&&l!==(l=r.status.report)&&(o.checked=l),t.displayStatuses&&h!==(h=r.status.text)&&(0,s.a_)(p,h),t.displayStatuses&&u!==(u="status-report-"+r.status.id)&&(d.htmlFor=u)},d(t){t&&(0,s.r2)(a),(0,s.ys)(o,"change",g)}}}function I(t,e){var r,a,o,n,i,l,c;function d(){t.set({forward:n.checked})}return{c(){r=(0,s.az)("p"),a=(0,s.rw)(e.forwardDescription),o=(0,s.rw)("\n          "),n=(0,s.az)("input"),i=(0,s.rw)("\n          "),l=(0,s.az)("label"),c=(0,s.rw)(e.forwardLabel),this.h()},l(t){r=(0,s.d$)(t,"P",{class:!0},!1);var d=(0,s.pI)(r);a=(0,s.M4)(d,e.forwardDescription),d.forEach(s.r2),o=(0,s.M4)(t,"\n          "),n=(0,s.d$)(t,"INPUT",{type:!0,id:!0,name:!0},!1),(0,s.pI)(n).forEach(s.r2),i=(0,s.M4)(t,"\n          "),l=(0,s.d$)(t,"LABEL",{for:!0,class:!0},!1);var p=(0,s.pI)(l);c=(0,s.M4)(p,e.forwardLabel),p.forEach(s.r2),this.h()},h(){r.className="svelte-1jqy48r",(0,s.NH)(n,"change",d),(0,s.P$)(n,"type","checkbox"),n.id="report-forward",n.name="report-forward",l.htmlFor="report-forward",l.className="svelte-1jqy48r"},m(t,d){(0,s.$T)(t,r,d),(0,s.R3)(r,a),(0,s.$T)(t,o,d),(0,s.$T)(t,n,d),n.checked=e.forward,(0,s.$T)(t,i,d),(0,s.$T)(t,l,d),(0,s.R3)(l,c)},p(t,e){t.forwardDescription&&(0,s.a_)(a,e.forwardDescription),t.forward&&(n.checked=e.forward),t.forwardLabel&&(0,s.a_)(c,e.forwardLabel)},d(t){t&&((0,s.r2)(r),(0,s.r2)(o),(0,s.r2)(n)),(0,s.ys)(n,"change",d),t&&((0,s.r2)(i),(0,s.r2)(l))}}}function q(t){var e;if((0,s.S1)(this,t),this.store=c.h,this._state=(0,s.f0)((0,s.f0)(this.store._init(["currentInstance"]),{account:void 0,status:void 0,positiveText:"Report",reportMap:{},recentStatuses:[],loading:!0,forward:!1,comment:""}),t.data),this.store._add(this,["currentInstance"]),this._recompute({status:1,recentStatuses:1,statuses:1,reportMap:1,account:1,$currentInstance:1,remoteInstance:1},this._state),this._intro=!0,this._handlers.destroy=[s.iT],document.getElementById("svelte-1jqy48r-style")||((e=(0,s.az)("style")).id="svelte-1jqy48r-style",e.textContent=".report-dialog-contents .confirmation-dialog-form{max-width:80vw}.report-dialog.svelte-1jqy48r{padding:20px 40px;overflow-y:auto}.loading-spinner-container.svelte-1jqy48r{width:100%;height:100%;display:flex;justify-content:center;align-items:center}ul.svelte-1jqy48r{list-style:none;max-height:30vh;overflow-y:auto;overflow-x:hidden;border:1px solid var(--main-border)}li.svelte-1jqy48r{padding:10px 5px;border-top:1px solid var(--main-border)}li.svelte-1jqy48r:first-child{border-top:none}.recent-statuses.svelte-1jqy48r label.svelte-1jqy48r{padding:10px 5px;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical}textarea.svelte-1jqy48r{width:100%;overflow-y:auto;max-height:40vh;font-size:1.3em;min-height:100px}p.svelte-1jqy48r{margin:20px 0}.recent-statuses.svelte-1jqy48r li.svelte-1jqy48r{display:flex;flex-direction:row;align-items:center}.recent-statuses.svelte-1jqy48r input.svelte-1jqy48r{margin-right:10px}.recent-statuses.svelte-1jqy48r label.svelte-1jqy48r{width:0;flex:1;word-wrap:break-word;overflow:hidden;white-space:pre-wrap;text-overflow:ellipsis;border-left:1px solid var(--main-border);padding-left:10px}.report-flex.svelte-1jqy48r{display:flex;flex-direction:row}.report-flex.svelte-1jqy48r>.svelte-1jqy48r{flex:1}.report-info.svelte-1jqy48r{margin-left:20px}@media(max-width: 767px){.report-dialog.svelte-1jqy48r{padding:20px;overflow-x:hidden;max-height:65vh}.report-flex.svelte-1jqy48r{flex-direction:column}.report-info.svelte-1jqy48r{margin-left:0}textarea.svelte-1jqy48r{max-height:20vh}p.svelte-1jqy48r,label.svelte-1jqy48r{word-wrap:break-word}.report-dialog-contents .confirmation-dialog-form{max-width:calc(100% - 20px)}}",(0,s.R3)(document.head,e)),this._fragment=function(t,e){var r,o,n,i,l,c,d,p,u,h,f,m,v,y=!1;function w(t){return t.loading?_:b}var g=w(e),x=g(t,e);function j(){y=!0,t.set({comment:m.value}),y=!1}var q=e.remoteInstance&&I(t,e),$={id:e.id,label:e.label,title:e.title,className:"report-dialog-contents",positiveText:e.positiveText},E=new a.Z({root:t.root,store:t.store,slots:{default:(0,s.xJ)()},data:$});return E.on("positive",(function(e){t.doReport()})),{c(){r=(0,s.az)("div"),o=(0,s.az)("div"),n=(0,s.az)("div"),x.c(),i=(0,s.rw)("\n      "),l=(0,s.az)("div"),c=(0,s.az)("p"),d=(0,s.rw)(e.reportingLabel),p=(0,s.rw)("\n        "),u=(0,s.az)("label"),h=(0,s.rw)("Additional comments"),f=(0,s.rw)("\n        "),m=(0,s.az)("textarea"),v=(0,s.rw)("\n        "),q&&q.c(),E._fragment.c(),this.h()},l(t){r=(0,s.d$)(t,"DIV",{class:!0},!1);var a=(0,s.pI)(r);o=(0,s.d$)(a,"DIV",{class:!0},!1);var y=(0,s.pI)(o);n=(0,s.d$)(y,"DIV",{class:!0},!1);var w=(0,s.pI)(n);x.l(w),w.forEach(s.r2),i=(0,s.M4)(y,"\n      "),l=(0,s.d$)(y,"DIV",{class:!0},!1);var g=(0,s.pI)(l);c=(0,s.d$)(g,"P",{class:!0},!1);var b=(0,s.pI)(c);d=(0,s.M4)(b,e.reportingLabel),b.forEach(s.r2),p=(0,s.M4)(g,"\n        "),u=(0,s.d$)(g,"LABEL",{class:!0,id:!0},!1);var _=(0,s.pI)(u);h=(0,s.M4)(_,"Additional comments"),_.forEach(s.r2),f=(0,s.M4)(g,"\n        "),m=(0,s.d$)(g,"TEXTAREA",{placeholder:!0,"aria-labelledby":!0,maxlength:!0,class:!0},!1),(0,s.pI)(m).forEach(s.r2),v=(0,s.M4)(g,"\n        "),q&&q.l(g),g.forEach(s.r2),y.forEach(s.r2),a.forEach(s.r2),E._fragment.l(t),this.h()},h(){n.className="recent-statuses svelte-1jqy48r",c.className="svelte-1jqy48r",u.className="sr-only svelte-1jqy48r",u.id="comments-label",(0,s.NH)(m,"input",j),m.placeholder="Additional comments",(0,s.P$)(m,"aria-labelledby","comments-label"),m.maxLength="1000",m.className="svelte-1jqy48r",l.className="report-info svelte-1jqy48r",o.className="report-flex svelte-1jqy48r",r.className="report-dialog svelte-1jqy48r"},m(t,a){(0,s.R3)(E._slotted.default,r),(0,s.R3)(r,o),(0,s.R3)(o,n),x.m(n,null),(0,s.R3)(o,i),(0,s.R3)(o,l),(0,s.R3)(l,c),(0,s.R3)(c,d),(0,s.R3)(l,p),(0,s.R3)(l,u),(0,s.R3)(u,h),(0,s.R3)(l,f),(0,s.R3)(l,m),m.value=e.comment,(0,s.R3)(l,v),q&&q.m(l,null),E._mount(t,a)},p(e,r){g===(g=w(r))&&x?x.p(e,r):(x.d(1),(x=g(t,r)).c(),x.m(n,null)),e.reportingLabel&&(0,s.a_)(d,r.reportingLabel),!y&&e.comment&&(m.value=r.comment),r.remoteInstance?q?q.p(e,r):((q=I(t,r)).c(),q.m(l,null)):q&&(q.d(1),q=null);var a={};e.id&&(a.id=r.id),e.label&&(a.label=r.label),e.title&&(a.title=r.title),e.positiveText&&(a.positiveText=r.positiveText),E._set(a)},d(t){x.d(),(0,s.ys)(m,"input",j),q&&q.d(),E.destroy(t)}}}(this,this._state),this.root._oncreate.push((()=>{w.call(this),this.fire("update",{changed:(0,s.lZ)({},this._state),current:this._state})})),t.target){var r=(0,s.pI)(t.target);t.hydrate?this._fragment.l(r):this._fragment.c(),r.forEach(s.r2),this._mount(t.target,t.anchor),(0,s.yl)(this)}}(0,s.f0)(q.prototype,s.uS),(0,s.f0)(q.prototype,y),q.prototype._recompute=function(t,e){(t.status||t.recentStatuses)&&this._differs(e.statuses,e.statuses=function({status:t,recentStatuses:e}){return[t].concat((e||[]).filter((({id:e})=>!t||e!==t.id))).filter(Boolean)}(e))&&(t.statuses=!0),(t.statuses||t.reportMap)&&this._differs(e.displayStatuses,e.displayStatuses=function({statuses:t,reportMap:e}){return t.map((t=>({id:t.id,text:(0,p.g)(t.content,t.mentions)||"(No content)",report:e[t.id]})))}(e))&&(t.displayStatuses=!0),t.account&&this._differs(e.remoteInstance,e.remoteInstance=function({account:t}){return t.acct.split("@")[1]}(e))&&(t.remoteInstance=!0),(t.account||t.$currentInstance)&&this._differs(e.reportingLabel,e.reportingLabel=function({account:t,$currentInstance:e}){return(0,m.A)(["You are reporting ",["account"]," to the moderators of ",["instance"],"."],{account:`@${t.acct}`,instance:e})}(e))&&(t.reportingLabel=!0),t.remoteInstance&&(this._differs(e.forwardDescription,e.forwardDescription=function({remoteInstance:t}){return(0,m.A)(["Forward to the moderators of ",["instance"]," as well?"],{instance:t})}(e))&&(t.forwardDescription=!0),this._differs(e.forwardLabel,e.forwardLabel=function({remoteInstance:t}){return(0,m.A)(["Forward to ",["instance"]],{instance:t})}(e))&&(t.forwardLabel=!0))};const $=q;var E=r(3634);function k({account:t,status:e}){const r=(0,m.A)(["Report ",["account"]],{account:`@${t.acct}`});return(0,E.v)($,{label:r,title:r,account:t,status:e})}}}]);
//# sourceMappingURL=7666.0d90fb86d88812ec70b3.7666.js.map