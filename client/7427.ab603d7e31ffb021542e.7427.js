"use strict";(this.webpackChunksemaphore=this.webpackChunksemaphore||[]).push([[7427],{6677:(t,s,e)=>{e.d(s,{re:()=>b,kh:()=>y,cd:()=>g,A_:()=>f});var n=e(5277),a=e(385),i=e(4886);var r=e(1370),c=e(1162),o=e(4285),u=e(7031),l=e(6633),p=e(4358);async function h(t,s){const{loggedInInstances:e}=n.h.get(),r=e[t].access_token;await s((()=>function(t,s){const e=`${(0,i.E)(t)}/api/v1/filters`;return(0,a.U2)(e,(0,i.I)(s),{timeout:a.EH})}(t,r)),(()=>c.F.getFilters(t)),(s=>c.F.setFilters(t,s)),(s=>{const{instanceFilters:e}=n.h.get();(0,o.Xy)(e[t],s)||(e[t]=s,n.h.set({instanceFilters:e}))}))}async function f(t){await h(t,r.u)}async function g(t){await h(t,r.o)}async function b(t,s){const{loggedInInstances:e}=n.h.get(),r=e[t].access_token;try{s.id?(await function(t,s,e){const n=`${(0,i.E)(t)}/api/v1/filters/${e.id}`;return(0,a.gz)(n,e,(0,i.I)(s),{timeout:a.$Q})}(t,r,s),u.A.say("Updated filter")):(await function(t,s,e){const n=`${(0,i.E)(t)}/api/v1/filters`;return(0,a.v_)(n,e,(0,i.I)(s),{timeout:a.$Q})}(t,r,s),u.A.say("Created filter")),(0,p.j)("wordFiltersChanged",t)}catch(c){u.A.say((0,l.A)(["Failed to modify filter: ",["error"]],c.message||""))}}async function y(t,s){const{loggedInInstances:e}=n.h.get(),r=e[t].access_token;try{await function(t,s,e){const n=`${(0,i.E)(t)}/api/v1/filters/${e}`;return(0,a.IV)(n,(0,i.I)(s),{timeout:a.$Q})}(t,r,s),u.A.say("Deleted filter"),(0,p.j)("wordFiltersChanged",t)}catch(c){u.A.say((0,l.A)(["Failed to modify filter: ",["error"]],c.message||""))}}},5060:(t,s,e)=>{e.d(s,{u:()=>u,Z:()=>o});var n=e(4886),a=e(385);async function i(t,s,e,i){const r=`${(0,n.E)(t)}/api/v1/push/subscription`;return(0,a.v_)(r,{subscription:e.toJSON(),data:{alerts:i}},(0,n.I)(s))}var r=e(5277);const c=t=>(t=>{const s=window.atob(t),e=new Uint8Array(s.length);for(let n=0;n<s.length;++n)e[n]=s.charCodeAt(n);return e})((t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"));async function o(t){const{loggedInInstances:s,currentPushSubscription:e}=r.h.get(),i=s[t].access_token;if(null===e)return;const o=await navigator.serviceWorker.ready,l=await o.pushManager.getSubscription();if(null===l)return r.h.setInstanceData(t,"pushSubscriptions",null),void r.h.save();try{const s=await async function(t,s){const e=`${(0,n.E)(t)}/api/v1/push/subscription`;return(0,a.U2)(e,(0,n.I)(s))}(t,i);btoa(c(s.server_key).buffer)!==btoa(l.options.applicationServerKey)?(await l.unsubscribe(),await async function(t,s){const e=`${(0,n.E)(t)}/api/v1/push/subscription`;return(0,a.IV)(e,(0,n.I)(s))}(t,i),await u(t,e.alerts)):(r.h.setInstanceData(t,"pushSubscriptions",s),r.h.save())}catch(p){p.message.startsWith("404:")&&(await l.unsubscribe(),r.h.setInstanceData(t,"pushSubscriptions",null),r.h.save())}}async function u(t,s){const{loggedInInstances:e}=r.h.get(),o=e[t].access_token,u=await navigator.serviceWorker.ready;let l=await u.pushManager.getSubscription();if(null===l){l=await u.pushManager.subscribe({applicationServerKey:c("BImgAz4cF_yvNFp8uoBJCaGpCX4d0atNIFMHfBvAAXCyrnn9IMAFQ10DW_ZvBCzGeR4fZI5FnEi2JVcRE-L88jY="),userVisibleOnly:!0});let e=await i(t,o,l,s);await l.unsubscribe(),l=await u.pushManager.subscribe({applicationServerKey:c(e.server_key),userVisibleOnly:!0}),e=await i(t,o,l,s),r.h.setInstanceData(t,"pushSubscriptions",e),r.h.save()}else try{const e=await async function(t,s,e){const i=`${(0,n.E)(t)}/api/v1/push/subscription`;return(0,a.gz)(i,{data:{alerts:e}},(0,n.I)(s))}(t,o,s);r.h.setInstanceData(t,"pushSubscriptions",e),r.h.save()}catch(p){const e=await i(t,o,l,s);r.h.setInstanceData(t,"pushSubscriptions",e),r.h.save()}}},5061:(t,s,e)=>{e.d(s,{AL:()=>r,B$:()=>a,M9:()=>o,Z3:()=>n,cT:()=>i,dS:()=>c,rs:()=>u,sr:()=>l});const n="homeReblogs",a="homeReplies",i="notificationReblogs",r="notificationFavs",c="notificationFollows",o="notificationMentions",u="notificationPolls",l="notificationSubscriptions"}}]);
//# sourceMappingURL=7427.ab603d7e31ffb021542e.7427.js.map